resources:
  - name: birth
    connection:
      adapter: sqlite3
      database: db/birth.sql
      timeout: 3000
    table: birth_all
  - name: death
    connection:
      adapter: sqlite3
      database: db/death.sql
      timeout: 3000
    table: death_all

transformers:
  - name: ssn_filter
    parameters:
      - x
    conditions:
      regex: "(\d)\1{8}"
    formula: "nil"

scenarios:
  - name: family
    type: self-join
    resource: birth
    transformations:
      MomSSN: ssn_filter
    matchers:
      - MomSSN: 
          formula: "(!a.nil? && a == b) ? 1 : 0"
